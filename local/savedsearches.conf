[Nagios - Top 100 Alerts]
action.email.reportServerEnabled = 0
dispatch.earliest_time = -7d@d
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_view = search
search = `nagios_index` `nagios_core_sourcetype` host_name="*" ((eventname="SERVICE ALERT" NOT status_code="OK") OR \
(eventname="HOST ALERT" NOT status_code="UP")) \
| eval name=if(eventname=="HOST ALERT","Host",service) \
| top eventname,host_name,name limit="100"

[Nagios Host Groups]
alert.digest_mode = 1
dispatch.earliest_time = 0
dispatch.latest_time = 
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_view = search
search = | stats count \
| livehostgroups\
| mvexpand livehostgroups_results\
| rex field=livehostgroups_results "(?<hostgroup>[^;]*);(?<num_hosts>[^;]*);(?<num_hosts_down>[^;]*);(?<num_hosts_pending>[^;]*);(?<num_hosts_unreach>[^;]*);(?<num_hosts_up>[^;]*);(?<num_services>[^;]*);(?<num_services_crit>[^;]*);(?<num_services_hard_crit>[^;]*);(?<num_services_hard_ok>[^;]*);(?<num_services_hard_unknown>[^;]*);(?<num_services_hard_warn>[^;]*);(?<num_services_ok>[^;]*);(?<num_services_pending>[^;]*);(?<num_services_unknown>[^;]*);(?<num_services_warn>[^;]*);(?<worst_host_state>[^;]*);(?<worst_service_hard_state>[^;]*);(?<worst_service_state>[^;]*)"\
| eval host_perc=(num_hosts_up/num_hosts)*100\
| eval host_perc=if(isnull(host_perc),"N/A: empty hostgroup",host_perc)\
| eval service_perc=(num_services_ok/num_services)*100\
| eval service_perc=if(isnull(service_perc),"N/A: empty servicegroup",service_perc)\
| table hostgroup num_hosts_up num_hosts host_perc num_services_ok num_services service_perc

[Nagios Service Groups]
alert.digest_mode = 1
dispatch.earliest_time = 0
dispatch.latest_time = 
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_view = search
search = | stats count\
| liveservicegroups\
| mvexpand liveservicegroups_results\
| rex field=liveservicegroups_results "(?<servicegroup>[^;]*);(?<num_services>[^;]*);(?<num_services_crit>[^;]*);(?<num_services_hard_crit>[^;]*);(?<num_services_hard_ok>[^;]*);(?<num_services_hard_unknown>[^;]*);(?<num_services_hard_warn>[^;]*);(?<num_services_ok>[^;]*);(?<num_services_pending>[^;]*);(?<num_services_unknown>[^;]*);(?<num_services_warn>[^;]*);(?<worst_service_state>.*)"\
| eval service_perc=(num_services_ok/num_services)*100\
| eval service_perc=if(isnull(service_perc),"N/A: empty servicegroup",service_perc)\
| table servicegroup num_services_ok num_services service_perc\
| sort servicegroup

[Host Status for all Host Groups]
alert.digest_mode = 1
dispatch.earliest_time = 0
dispatch.latest_time = 
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_view = search
search = | stats count\
| livehostgroupstatus\
| mvexpand livehoststatus_results\
| rex field=livehoststatus_results "((?<host_name>.*)\|(?<livehoststatus>.*)\|(?<num>.*)|)\|(?<hostgroup>.*)"\
| eval host_name=if(isnull(host_name),"N/A: empty hostgroup",host_name)\
| eval livehoststatus=if(isnull(livehoststatus),"N/A: empty hostgroup",livehoststatus)\
| table hostgroup host_name livehoststatus \
| sort hostgroup,host_name

[Service Status for all Service Groups]
alert.digest_mode = 1
dispatch.earliest_time = 0
dispatch.latest_time = 
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_view = search
search = | stats count\
| liveservicegroupstatus\
| mvexpand liveservicestatus_results\
| rex field=liveservicestatus_results "((?<host_name>.*)\|(?<service>.*)\|(?<liveservicestatus>.*)\|(?<num>.*)|)\|(?<servicegroup>.*)"\
| eval host_name=if(isnull(host_name),"N/A: empty servicegroup",host_name)\
| eval service=if(isnull(service),"N/A: empty servicegroup",service)\
| eval liveservicestatus=if(isnull(liveservicestatus),"N/A: empty servicegroup",liveservicestatus)\
| table servicegroup host_name service liveservicestatus \
| sort servicegroup,host_name,service
